-- PHASE V: TABLE IMPLEMENTATION AND DATA INSERTION


-- Table Creation


-- USER TABLE
CREATE TABLE users (
    user_id      NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    username     VARCHAR2(50) UNIQUE NOT NULL,
    email        VARCHAR2(100) UNIQUE NOT NULL,
    password     VARCHAR2(100) NOT NULL,
    created_at   DATE DEFAULT SYSDATE
);

-- HABIT TABLE
CREATE TABLE habit (
    habit_id     NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    user_id      NUMBER REFERENCES users(user_id),
    title        VARCHAR2(100) NOT NULL,
    description  VARCHAR2(255),
    frequency    VARCHAR2(20) CHECK (frequency IN ('daily', 'weekly', 'monthly')),
    start_date   DATE,
    status       VARCHAR2(20) DEFAULT 'active' CHECK (status IN ('active', 'paused', 'completed'))
);

-- GOAL TABLE
CREATE TABLE goal (
    goal_id      NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    user_id      NUMBER REFERENCES users(user_id),
    title        VARCHAR2(100) NOT NULL,
    description  VARCHAR2(255),
    target_date  DATE,
    status       VARCHAR2(20) DEFAULT 'in-progress' CHECK (status IN ('in-progress', 'achieved', 'failed'))
);

-- ALARM TABLE
CREATE TABLE alarm (
    alarm_id     NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    habit_id     NUMBER REFERENCES habit(habit_id),
    alarm_time   VARCHAR2(10), -- e.g., '08:00 AM'
    recurrence   VARCHAR2(20),
    is_active    CHAR(1) DEFAULT 'Y' CHECK (is_active IN ('Y', 'N'))
);

-- HABIT_LOG TABLE
CREATE TABLE habit_log (
    log_id       NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    habit_id     NUMBER REFERENCES habit(habit_id),
    log_date     DATE,
    status       VARCHAR2(20) CHECK (status IN ('completed', 'missed')),
    note         VARCHAR2(255)
);

-- GOAL_STATUS TABLE
CREATE TABLE goal_status (
    status_id            NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    goal_id              NUMBER REFERENCES goal(goal_id),
    update_date          DATE,
    progress_note        VARCHAR2(255),
    completion_percentage NUMBER(5,2) CHECK (completion_percentage BETWEEN 0 AND 100)
);







-- Data insertion


-- USERS TABLE
INSERT INTO users (username, email, password)
VALUES 
('pacifique', 'pacifique@example.com', 'pass123');


INSERT INTO habit (user_id, title, description, frequency, start_date, status) VALUES (1, 'Morning Workout', 'Cardio and strength', 'daily', SYSDATE - 6, 'active');
INSERT INTO habit (user_id, title, description, frequency, start_date, status) VALUES (1, 'Reading', 'Read 30 pages daily', 'daily', SYSDATE - 5, 'active');
INSERT INTO habit (user_id, title, description, frequency, start_date, status) VALUES (1, 'Coding Practice', 'LeetCode challenges', 'daily', SYSDATE - 4, 'active');
INSERT INTO habit (user_id, title, description, frequency, start_date, status) VALUES (1, 'Journal Writing', 'Write thoughts', 'daily', SYSDATE - 3, 'paused');
INSERT INTO habit (user_id, title, description, frequency, start_date, status) VALUES (1, 'Meditation', '10 minutes breathing', 'daily', SYSDATE - 2, 'completed');
INSERT INTO habit (user_id, title, description, frequency, start_date, status) VALUES (1, 'Drink Water', '8 glasses daily', 'daily', SYSDATE - 1, 'active');
INSERT INTO habit (user_id, title, description, frequency, start_date, status) VALUES (1, 'Evening Walk', '15 mins after dinner', 'daily', SYSDATE, 'active');


INSERT INTO goal (user_id, title, description, target_date, status) VALUES (1, 'Lose 5kg', 'Weight loss goal', SYSDATE + 60, 'in-progress');
INSERT INTO goal (user_id, title, description, target_date, status) VALUES (1, 'Read 10 books', 'By end of term', SYSDATE + 90, 'in-progress');
INSERT INTO goal (user_id, title, description, target_date, status) VALUES (1, 'Get Oracle Certified', 'Finish training + exam', SYSDATE + 45, 'in-progress');
INSERT INTO goal (user_id, title, description, target_date, status) VALUES (1, 'Develop App', 'Build habit tracking app', SYSDATE + 70, 'in-progress');
INSERT INTO goal (user_id, title, description, target_date, status) VALUES (1, 'Improve Sleep', 'Consistent sleep by 10pm', SYSDATE + 30, 'achieved');
INSERT INTO goal (user_id, title, description, target_date, status) VALUES (1, 'Finish SQL Project', 'Capstone phase VIII', SYSDATE + 15, 'in-progress');
INSERT INTO goal (user_id, title, description, target_date, status) VALUES (1, 'Run 5km', 'Without stopping', SYSDATE + 40, 'in-progress');


INSERT INTO alarm (habit_id, alarm_time, recurrence, is_active) VALUES (1, '06:30 AM', 'daily', 'Y');
INSERT INTO alarm (habit_id, alarm_time, recurrence, is_active) VALUES (2, '08:00 PM', 'daily', 'Y');
INSERT INTO alarm (habit_id, alarm_time, recurrence, is_active) VALUES (3, '07:00 AM', 'daily', 'Y');
INSERT INTO alarm (habit_id, alarm_time, recurrence, is_active) VALUES (4, '09:30 PM', 'daily', 'N');
INSERT INTO alarm (habit_id, alarm_time, recurrence, is_active) VALUES (5, '07:15 AM', 'daily', 'Y');
INSERT INTO alarm (habit_id, alarm_time, recurrence, is_active) VALUES (6, '09:00 AM', 'daily', 'Y');
INSERT INTO alarm (habit_id, alarm_time, recurrence, is_active) VALUES (7, '06:00 PM', 'daily', 'Y');



INSERT INTO habit_log (habit_id, log_date, status, note) VALUES (1, SYSDATE - 1, 'completed', 'Workout done');
INSERT INTO habit_log (habit_id, log_date, status, note) VALUES (2, SYSDATE - 2, 'missed', 'Was too tired');
INSERT INTO habit_log (habit_id, log_date, status, note) VALUES (3, SYSDATE - 1, 'completed', 'Solved 3 problems');
INSERT INTO habit_log (habit_id, log_date, status, note) VALUES (4, SYSDATE - 3, 'missed', 'Forgot to journal');
INSERT INTO habit_log (habit_id, log_date, status, note) VALUES (5, SYSDATE - 2, 'completed', 'Felt calm');
INSERT INTO habit_log (habit_id, log_date, status, note) VALUES (6, SYSDATE - 1, 'completed', 'All 8 glasses done');
INSERT INTO habit_log (habit_id, log_date, status, note) VALUES (7, SYSDATE, 'completed', 'Walked 20 minutes');



INSERT INTO goal_status (goal_id, update_date, progress_note, completion_percentage) VALUES (1, SYSDATE - 1, 'Lost 1kg', 20);
INSERT INTO goal_status (goal_id, update_date, progress_note, completion_percentage) VALUES (2, SYSDATE - 2, '2 books done', 20);
INSERT INTO goal_status (goal_id, update_date, progress_note, completion_percentage) VALUES (3, SYSDATE - 1, 'Completed 3 modules', 30);
INSERT INTO goal_status (goal_id, update_date, progress_note, completion_percentage) VALUES (4, SYSDATE - 1, 'Wireframe complete', 15);
INSERT INTO goal_status (goal_id, update_date, progress_note, completion_percentage) VALUES (5, SYSDATE - 3, 'Sleeping at 10:15pm', 90);
INSERT INTO goal_status (goal_id, update_date, progress_note, completion_percentage) VALUES (6, SYSDATE - 1, 'Halfway through PL/SQL', 50);
INSERT INTO goal_status (goal_id, update_date, progress_note, completion_percentage) VALUES (7, SYSDATE, 'Ran 3km nonstop', 60);



SELECT * FROM users;
SELECT * FROM habit;
SELECT * FROM goal;
SELECT * FROM alarm;
SELECT * FROM habit_log;
SELECT * FROM goal_status;







